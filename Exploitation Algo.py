import numpy as np

# Initialization
M = 10000  # Total number of episodes
K = 100    # Total number of trials
N = 4      # Number of machines
p1 = 0.3   # Success rate of machine 1
p2 = 0.5   # Success rate of machine 2
p3 = 0.2   # Success rate of machine 3
p4 = 0.8   # Success rate of machine 4
r = 1      # Reward of a success trial
Final_total_return = 0

# Main Loop
for ii in range(1, M + 1):
    total_return = 0
    first_success = 0

    # Nested Loop for Trials
    for k in range(1, K + 1):
        if first_success == 0:
            r_k = k % N
            if r_k == 0:
                p_k = p4
            elif r_k == 1:
                p_k = p1
            elif r_k == 2:
                p_k = p2
            else:
                p_k = p3
            p_action_success = np.random.rand()
            if p_action_success < p_k:  # trial successful
                first_success = 1
                total_return += r
        else:
            p_action_success = np.random.rand()
            if p_action_success < p_k:  # trial successful
                total_return += r

    # Updating Total Return
    Final_total_return += total_return

# Calculating Average Return
Average_return = Final_total_return / M

print("Average Return:", Average_return)
